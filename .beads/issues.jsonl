{"id":"p5.gen-1yr","title":"Implement particles.ts - Particle Systems","description":"## Phase 3: Simulations (Module 9 of 12)\n**Complexity:** High\nObject pooling, optional Quadtree\n\n## Purpose\nExplosions, smoke, trails, physics simulations.\n\n## Key Exports\n```typescript\nimport { type Point2D } from './penrose';\nimport { type Quadtree } from './quadtree';\n\nexport type ParticleConfig = {\n  readonly lifespan?: number;\n  readonly mass?: number;\n  readonly drag?: number;\n};\n\nexport type EmitConfig = {\n  readonly velocity?: p5.Vector;\n  readonly velocitySpread?: number;\n  readonly lifespan?: number;\n  readonly lifespanSpread?: number;\n  readonly random?: () =\u003e number;\n};\n\nexport type ParticleSystemConfig = {\n  readonly maxParticles?: number;\n  readonly useQuadtree?: boolean;\n};\n\nexport class Particle implements Point2D {\n  readonly id: number;\n  readonly x: number;  // For Point2D compatibility\n  readonly y: number;\n  position: p5.Vector;\n  velocity: p5.Vector;\n  acceleration: p5.Vector;\n  lifespan: number;\n  age: number;\n  mass: number;\n\n  update(dt: number): void;\n  applyForce(force: p5.Vector): void;\n  isDead(): boolean;\n  reset(): void;  // For object pooling\n}\n\nexport class ParticleSystem {\n  constructor(config?: ParticleSystemConfig);\n  emit(count: number, position: p5.Vector, config?: EmitConfig): void;\n  update(dt: number): void;\n  applyForce(force: p5.Vector): void;\n  applyForceAt(force: p5.Vector, position: p5.Vector, radius: number): void;\n  getAlive(): readonly Particle[];\n  getCount(): number;\n  clear(): void;\n}\n\nexport function createParticleSystem(config?: ParticleSystemConfig): ParticleSystem;\n```\n\n## Object Pooling Pattern\n```typescript\nclass ParticleSystem {\n  private pool: Particle[] = [];\n  private active: Particle[] = [];\n\n  private acquire(): Particle {\n    return this.pool.pop() ?? new Particle();\n  }\n\n  private release(p: Particle): void {\n    p.reset();  // Clear state\n    this.pool.push(p);\n  }\n}\n```\n\n## Required Test Cases\n- lifespan=0 → particle dies immediately\n- emit(0) → no-op\n- Dead particles removed from active list\n- Force applies to all particles\n- Object pooling works (particles reused)\n\n## Edge Cases\n- Zero lifespan → remove immediately\n- Negative velocity → valid, reverses direction\n- No forces → particles maintain velocity\n- 10,000+ particles → use object pooling internally\n\n## Visual Test\nFile: `visual-tests/sketches/particles.sketch.ts`\nPass condition: Fountain with gravity, continuous emission, 500+ particles at 60fps\n\n## Reference Pattern\n- src/circlePacking.ts (particle-like system pattern)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:57:14.443692+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:57:14.443692+01:00","dependencies":[{"issue_id":"p5.gen-1yr","depends_on_id":"p5.gen-c7o","type":"blocks","created_at":"2026-01-02T13:58:45.521036+01:00","created_by":"martinblasko"}]}
{"id":"p5.gen-7mi","title":"p5.gen Library Improvements","description":"5 iterations to improve p5.gen library quality (strict 250-line compliance).\n\n**Summary:**\n- Files to split: 11 → ~36\n- New test files: 15\n- Target coverage: 90%+\n\n**Key principle:** Tests before refactoring (safety net).\n\n**Git Strategy:** Each iteration gets its own branch, merged only after all tests pass.","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-02T13:50:18.741084+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:50:18.741084+01:00"}
{"id":"p5.gen-7mi.1","title":"Iteration 1: Fix any type in penrose.ts","description":"**Task:** Replace `any` type in `penrose.ts:95`\n\n```typescript\n// Before\nconst g = typeof globalThis !== 'undefined' ? (globalThis as any) : {}\n\n// After  \nconst g = typeof globalThis !== 'undefined' ? globalThis : ({} as Record\u003cstring, unknown\u003e)\n```\n\n**Git branch:** `iter-1-any-fix`\n\n**Validation:**\n- [ ] `bun run check` passes\n- [ ] Commit and merge to main","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:50:36.100574+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:50:36.100574+01:00","dependencies":[{"issue_id":"p5.gen-7mi.1","depends_on_id":"p5.gen-7mi","type":"parent-child","created_at":"2026-01-02T13:50:36.102491+01:00","created_by":"martinblasko"}]}
{"id":"p5.gen-7mi.2","title":"Iteration 2: Test Foundation - Create 10 test files","description":"Create unit tests for 10 modules that need splitting but lack tests.\n\n**Modules to test:**\n1. `circlePacking.ts` (747 lines) - packCircles, strategies, collision detection\n2. `voronoi.ts` (669 lines) - createVoronoi, Lloyd relaxation, cell lookup\n3. `catmullRom.ts` (623 lines) - Spline generation, interpolation, tension params\n4. `penrose.ts` (586 lines) - L-system rules, kite-dart generation\n5. `reactionDiffusion.ts` (533 lines) - Gray-Scott step, feed/kill rates\n6. `worleyNoise.ts` (445 lines) - Noise generation, distance functions\n7. `marchingSquares.ts` (444 lines) - Contour extraction, threshold handling\n8. `delaunay.ts` (442 lines) - Triangulation, circumcircle tests\n9. `truchet.ts` (402 lines) - Tile generation, rotation variants\n10. `polygons.ts` (402 lines) - Clipping, point-in-polygon, hatching\n\n**Test requirements:**\n- 5+ test cases per exported function\n- Cover edge cases: empty input, single element, large datasets\n- Use seeded random for deterministic results\n\n**Note:** circle.ts already has tests - update imports after split.\n\n**Git branch:** `iter-2-test-foundation`\n\n**Validation:**\n- [ ] `bun test` passes\n- [ ] All 10 new test files created","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:50:55.048067+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:50:55.048067+01:00","dependencies":[{"issue_id":"p5.gen-7mi.2","depends_on_id":"p5.gen-7mi","type":"parent-child","created_at":"2026-01-02T13:50:55.050198+01:00","created_by":"martinblasko"},{"issue_id":"p5.gen-7mi.2","depends_on_id":"p5.gen-7mi.1","type":"blocks","created_at":"2026-01-02T13:51:48.781565+01:00","created_by":"martinblasko"}]}
{"id":"p5.gen-7mi.3","title":"Iteration 3: Split 11 files into subdirectories","description":"Split ALL 11 files exceeding 250 lines (strict compliance).\n\n**Order of operations** (largest first):\n\n| Order | File | Lines | New Structure |\n|-------|------|-------|---------------|\n| 1 | circlePacking.ts | 747 | packing/ (core, strategies, types) |\n| 2 | voronoi.ts | 669 | voronoi/ (diagram, lloyd, types) |\n| 3 | catmullRom.ts | 623 | curves/ (spline, interpolation) |\n| 4 | penrose.ts | 586 | penrose/ (lsystem, kitedart) |\n| 5 | truchet.ts | 402 | truchet/ (patterns, renderer) |\n| 6 | reactionDiffusion.ts | 533 | simulation/ (grayscott, step) |\n| 7 | circle.ts | 465 | circle/ (core, intersections, tangents) |\n| 8 | polygons.ts | 402 | polygon/ (core, hatching) |\n| 9 | worleyNoise.ts | 445 | worley/ (noise, distance) |\n| 10 | marchingSquares.ts | 444 | marching/ (core, lookup) |\n| 11 | delaunay.ts | 442 | delaunay/ (core, utils) |\n\n**Note:** Each subdirectory has index.ts for re-exports. Max depth: 1 level.\n\n**Strategy:**\n1. Create subdirectory with index.ts barrel export\n2. Move code to focused files (\u003c250 lines each)\n3. Re-export from src/index.ts (preserve public API)\n4. Update test imports to use new paths\n5. Run bun test after each file split\n6. Run bun run visual-test after each category\n\n**Git branch:** `iter-3-file-splits`\n\n**Validation:**\n- [ ] No file \u003e250 lines\n- [ ] All tests pass\n- [ ] Visual tests pass","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:51:11.149024+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:51:11.149024+01:00","dependencies":[{"issue_id":"p5.gen-7mi.3","depends_on_id":"p5.gen-7mi","type":"parent-child","created_at":"2026-01-02T13:51:11.151108+01:00","created_by":"martinblasko"},{"issue_id":"p5.gen-7mi.3","depends_on_id":"p5.gen-7mi.2","type":"blocks","created_at":"2026-01-02T13:51:48.800349+01:00","created_by":"martinblasko"}]}
{"id":"p5.gen-7mi.4","title":"Iteration 4: Test Coverage - Create 5 test files for small modules","description":"Add tests for smaller modules (under 250 lines, don't need splitting).\n\n**Modules to test:**\n| Module | Lines | Priority |\n|--------|-------|----------|\n| vec2.ts | ~50 | High |\n| peano.ts | ~150 | Medium |\n| simplexCurl.ts | ~200 | Medium |\n| warp.ts | ~100 | Medium |\n| triangles.ts | ~200 | Lower |\n\n**Git branch:** `iter-4-test-coverage`\n\n**Validation:**\n- [ ] 90%+ module test coverage achieved\n- [ ] All tests pass","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:51:20.808427+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:51:20.808427+01:00","dependencies":[{"issue_id":"p5.gen-7mi.4","depends_on_id":"p5.gen-7mi","type":"parent-child","created_at":"2026-01-02T13:51:20.810341+01:00","created_by":"martinblasko"},{"issue_id":"p5.gen-7mi.4","depends_on_id":"p5.gen-7mi.3","type":"blocks","created_at":"2026-01-02T13:51:48.820158+01:00","created_by":"martinblasko"}]}
{"id":"p5.gen-7mi.5","title":"Iteration 5: Complete API documentation","description":"Update docs/API_REFERENCE.md with complete documentation.\n\n**Tasks:**\n- Document any new modules from splits\n- Ensure all public exports have entries\n- Add examples for complex functions\n\n**Git branch:** `iter-5-docs`\n\n**Validation:**\n- [ ] Every export in index.ts documented\n- [ ] Examples provided for complex functions","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:51:33.030669+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:51:33.030669+01:00","dependencies":[{"issue_id":"p5.gen-7mi.5","depends_on_id":"p5.gen-7mi","type":"parent-child","created_at":"2026-01-02T13:51:33.0325+01:00","created_by":"martinblasko"},{"issue_id":"p5.gen-7mi.5","depends_on_id":"p5.gen-7mi.4","type":"blocks","created_at":"2026-01-02T13:51:48.838331+01:00","created_by":"martinblasko"}]}
{"id":"p5.gen-7og","title":"Implement boids.ts - Flocking Behavior","description":"## Phase 3: Simulations (Module 10 of 12)\n**Complexity:** High\nQuadtree rebuild per frame\n\n## Purpose\nReynolds flocking algorithm for birds, fish, crowd simulation. Classic generative art algorithm.\n\n## Key Exports\n```typescript\nimport { type Point2D } from './penrose';\nimport { type Quadtree } from './quadtree';\n\nexport type FlockConfig = {\n  readonly separationWeight?: number;\n  readonly alignmentWeight?: number;\n  readonly cohesionWeight?: number;\n  readonly perceptionRadius?: number;\n  readonly separationRadius?: number;\n  readonly useQuadtree?: boolean;\n};\n\nexport class Boid implements Point2D {\n  readonly id: number;\n  readonly x: number;  // For Point2D compatibility\n  readonly y: number;\n  position: p5.Vector;\n  velocity: p5.Vector;\n  acceleration: p5.Vector;\n  maxSpeed: number;\n  maxForce: number;\n\n  update(): void;\n  applyForce(force: p5.Vector): void;\n}\n\n/**\n * Manages a flock of boids with Reynolds flocking behavior.\n *\n * ⚠️ If useQuadtree is true, the internal Quadtree is rebuilt\n * every call to update() since boids move continuously.\n */\nexport class Flock {\n  constructor(config?: FlockConfig);\n  addBoid(position: p5.Vector, velocity?: p5.Vector): Boid;\n  removeBoid(boid: Boid): void;\n  update(): void;\n  getBoids(): readonly Boid[];\n}\n\nexport function createFlock(config?: FlockConfig): Flock;\n\n// Standalone force functions (useful for custom behaviors)\nexport function separation(boid: Boid, neighbors: readonly Boid[], radius: number): p5.Vector;\nexport function alignment(boid: Boid, neighbors: readonly Boid[]): p5.Vector;\nexport function cohesion(boid: Boid, neighbors: readonly Boid[]): p5.Vector;\n```\n\n## Quadtree Rebuild Per Frame\n```typescript\nexport class Flock {\n  update(): void {\n    if (this.useQuadtree) {\n      this.quadtree.clear();\n      for (const boid of this.boids) {\n        this.quadtree.insert(boid);\n      }\n    }\n    // Then compute forces...\n  }\n}\n```\n\n## Required Test Cases\n- Single boid → unchanged (no forces applied)\n- Separation pushes boids apart\n- Quadtree rebuild per update verified\n\n## Edge Cases\n- Single boid → no forces applied\n- No neighbors in radius → random wander\n- Boids at same position → separation force maxes out\n- Boundary behavior → configurable (wrap, bounce, steer)\n\n## Visual Test\nFile: `visual-tests/sketches/boids.sketch.ts`\nPass condition: 30+ boids flocking, no stuck/oscillating behavior, emergent patterns\n\n## Reference Pattern\n- src/circlePacking.ts (physics-based system)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:57:15.575889+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:57:15.575889+01:00","dependencies":[{"issue_id":"p5.gen-7og","depends_on_id":"p5.gen-c7o","type":"blocks","created_at":"2026-01-02T13:58:46.479256+01:00","created_by":"martinblasko"}]}
{"id":"p5.gen-84p","title":"Implement lsystem.ts - Lindenmayer Systems","description":"## Phase 2: Patterns (Module 5 of 12)\n**Complexity:** Medium\nReuse LineSegment from marchingSquares\n\n## Purpose\nProcedural plants, fractals, branching structures. Penrose only handles one case.\n\n## CRITICAL: Type Reuse\n**Import LineSegment from './marchingSquares'** - DO NOT redefine\n\n## Key Exports\n```typescript\nimport { LineSegment } from './marchingSquares';\n\nexport type LSystemRule = {\n  readonly symbol: string;\n  readonly replacement: string | readonly string[];\n  readonly probability?: number;\n};\n\nexport type TurtleConfig = {\n  readonly angle: number;\n  readonly length: number;\n  readonly startPosition?: p5.Vector;\n  readonly startAngle?: number;\n};\n\nexport type LSystemPreset = {\n  readonly axiom: string;\n  readonly rules: readonly LSystemRule[];\n  readonly angle: number;\n};\n\nexport class LSystem {\n  constructor(axiom: string, rules: readonly LSystemRule[], random?: () =\u003e number);\n  iterate(generations: number): string;\n  getResult(): string;\n  reset(): void;\n}\n\nexport class TurtleInterpreter {\n  // Returns existing LineSegment type from marchingSquares\n  interpret(instructions: string, config: TurtleConfig): LineSegment[];\n}\n\nexport const PRESETS: {\n  readonly KOCH: LSystemPreset;\n  readonly SIERPINSKI: LSystemPreset;\n  readonly DRAGON: LSystemPreset;\n  readonly PLANT: LSystemPreset;\n};\n```\n\n## Required Test Cases\n- KOCH 3 iterations matches expected string\n- Empty axiom returns \"\"\n- generations \u003e 12 → warn and cap at 12\n\n## Edge Cases\n- generations \u003e 12 → warn and cap (exponential growth)\n- Empty axiom → return empty string\n- No matching rules → character passes through unchanged\n- Unbalanced brackets → track depth, warn if mismatch\n\n## Visual Test\nFile: `visual-tests/sketches/lsystem.sketch.ts`\nPass condition: PLANT preset at depth 4-5, tree-like branching visible\n\n## Reference Pattern\n- src/penrose.ts (PenroseLSystem - turtle graphics pattern)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:55:21.315959+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:55:21.315959+01:00"}
{"id":"p5.gen-al5","title":"Implement superformula.ts - Parametric Shapes","description":"## Phase 2: Patterns (Module 8 of 12)\n**Complexity:** Low\nSingle formula + presets\n\n## Purpose\nGielis superformula generates circles, stars, petals, organic shapes with a single equation.\n\n## Key Exports\n```typescript\nexport type SuperformulaParams = {\n  readonly m: number;\n  readonly n1: number;\n  readonly n2: number;\n  readonly n3: number;\n  readonly a?: number;\n  readonly b?: number;\n};\n\nexport function superformula(theta: number, params: SuperformulaParams): number;\nexport function superformulaPoints(params: SuperformulaParams, steps: number, scale?: number): p5.Vector[];\n\nexport const PRESETS: {\n  readonly CIRCLE: SuperformulaParams;\n  readonly STAR: SuperformulaParams;\n  readonly PETAL: SuperformulaParams;\n  readonly LEAF: SuperformulaParams;\n  readonly GEAR: SuperformulaParams;\n  readonly BUTTERFLY: SuperformulaParams;\n};\n```\n\n## Required Test Cases\n- CIRCLE preset is actually circular (r constant)\n- m=5 has 5 lobes\n- a=0 or b=0 handled gracefully\n\n## Edge Cases\n- Division by zero when a or b is 0\n- Negative m → can produce inverted shapes\n- Very large exponents → numerical instability\n- NaN results → check and return fallback\n\n## Numerical Stability\n- cos(θ)^n1 when n1 is large → Use Math.pow(Math.abs(cos), n1)\n\n## Visual Test\nFile: `visual-tests/sketches/superformula.sketch.ts`\nPass condition: Grid of 6 presets showing variety\n\n## Reference Pattern\n- src/penrose.ts (presets object pattern)\n- src/circle.ts (pure functions)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:55:26.566515+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:55:26.566515+01:00"}
{"id":"p5.gen-c7o","title":"Implement quadtree.ts - Spatial Indexing","description":"## Phase 1: Foundation (Module 1 of 12)\n**Complexity:** Medium\n**Must complete first** - Phase 3 modules optionally use this\n\n## Purpose\nEnables O(log n) neighbor queries. Without it, simulations are O(n²).\n\n## Key Exports\n```typescript\nimport { type Point2D } from './penrose';\n\nexport type QuadtreeBounds = {\n  readonly x: number;\n  readonly y: number;\n  readonly w: number;\n  readonly h: number;\n};\n\nexport class Quadtree\u003cT extends Point2D\u003e {\n  constructor(bounds: QuadtreeBounds, capacity?: number);\n  insert(point: T): boolean;\n  queryRange(range: QuadtreeBounds): T[];\n  queryRadius(center: Point2D, radius: number): T[];\n  clear(): void;\n  size(): number;\n}\n\nexport function createQuadtree\u003cT extends Point2D\u003e(\n  bounds: QuadtreeBounds,\n  capacity?: number\n): Quadtree\u003cT\u003e;\n```\n\n## IMPORTANT: Type Reuse\n- Import Point2D from './penrose' - DO NOT redefine\n- Quadtree generic constraint: `\u003cT extends Point2D\u003e`\n\n## Required Test Cases\n- Empty query returns []\n- Boundary point included in results\n- 10K point insert+query performance \u003c 10ms\n\n## Edge Cases\n- Empty tree query → return []\n- Point exactly on boundary → include in results\n- Query larger than tree → return all points\n- Duplicate points → allow (multi-insert)\n- 10,000+ points → max depth limit (10) prevents stack overflow\n\n## Visual Test\nFile: `visual-tests/sketches/quadtree.sketch.ts`\nPass condition: Shows tree structure, highlights query region with found points\n\n## JSDoc Warning to Include\n```typescript\n/**\n * Quadtree for spatial queries.\n *\n * ⚠️ Points are stored by reference. If a point moves after insertion,\n * you must call clear() and re-insert all points for correct queries.\n */\n```\n\n## Reference Pattern\n- src/poisson.ts (spatial hashing pattern)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:53:23.586523+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:53:23.586523+01:00"}
{"id":"p5.gen-dr2","title":"Add 12 New Algorithms to p5.gen","description":"Add 12 essential generative art algorithms to p5.gen in 3 phases.\n\n## Overview\n- Phase 1: Foundation (4 modules) - Must complete first\n- Phase 2: Patterns (4 modules) - Independent, any order\n- Phase 3: Simulations (4 modules) - After Phase 1 quadtree\n\n## Technical Decisions\n- Reuse Point2D from penrose.ts (DO NOT redefine)\n- Reuse LineSegment from marchingSquares.ts (DO NOT redefine)\n- Use Harmonic type (NOT Partial - conflicts with TypeScript)\n- Add factory functions (createQuadtree, createFlock, etc.)\n- Use kebab-case for visual test files\n\n## Per-Module Checklist\n- [ ] src/{module}.ts - Implementation with JSDoc\n- [ ] src/{module}.test.ts - Unit tests (mock createVector)\n- [ ] src/index.ts - Add exports\n- [ ] bun run check - Clean\n- [ ] bun test - Pass\n- [ ] visual-tests/sketches/{kebab}.sketch.ts - Visual test\n- [ ] bun run visual-test - Renders correctly\n- [ ] docs/API_REFERENCE.md - Document exports\n\n## Acceptance Criteria\n- All 12 modules pass bun run check\n- All unit tests pass\n- All 12 visual tests render correctly\n- No regressions in existing 19 visual tests\n- src/index.ts exports all new modules\n- docs/API_REFERENCE.md updated\n- No duplicate type definitions","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-02T13:51:56.368074+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:51:56.368074+01:00"}
{"id":"p5.gen-jq9","title":"Implement cellularAutomata.ts - Grid Simulations","description":"## Phase 2: Patterns (Module 6 of 12)\n**Complexity:** Medium\nUse Uint8Array for grid storage\n\n## Purpose\nGame of Life, emergent patterns, texture generation.\n\n## Key Exports\n```typescript\nexport type NeighborhoodType = 'moore' | 'vonNeumann';\nexport type BoundaryType = 'wrap' | 'dead' | 'mirror';\nexport type RuleFunction = (cell: number, neighbors: readonly number[]) =\u003e number;\n\nexport type CellularAutomataConfig = {\n  readonly width: number;\n  readonly height: number;\n  readonly neighborhood?: NeighborhoodType;\n  readonly boundary?: BoundaryType;\n};\n\nexport class CellularAutomata {\n  constructor(config: CellularAutomataConfig, rule: RuleFunction);\n  step(): void;\n  stepN(n: number): void;\n  getCell(x: number, y: number): number;\n  setCell(x: number, y: number, state: number): void;\n  getGrid(): Uint8Array;\n  getGeneration(): number;\n  randomize(density?: number, random?: () =\u003e number): void;\n}\n\nexport function elementaryCA(rule: number, width: number, generations: number): Uint8Array[];\n\nexport const RULES: {\n  readonly GAME_OF_LIFE: RuleFunction;\n  readonly BRIANS_BRAIN: RuleFunction;\n  readonly SEEDS: RuleFunction;\n  readonly HIGHLIFE: RuleFunction;\n};\n```\n\n## Implementation Details\nUse Uint8Array for memory efficiency:\n```typescript\nprivate grid: Uint8Array;\nprivate nextGrid: Uint8Array;\n\n// Access pattern (row-major)\ngetCell(x: number, y: number): number {\n  return this.grid[y * this.width + x] ?? 0;\n}\n```\n\n## Required Test Cases\n- GOL Glider positions at generation 0, 4, 8\n- wrap vs dead boundary behavior\n- Edge cells handled correctly\n\n## Edge Cases\n- Grid smaller than 3x3 → throw (too small for rules)\n- wrap=false edge cells → use dead (0) neighbors\n- All cells dead → valid state (no auto-seed)\n\n## Visual Test\nFile: `visual-tests/sketches/cellular-automata.sketch.ts` (kebab-case!)\nPass condition: GOL glider moves diagonally across 20 frames\n\n## Reference Pattern\n- src/reactionDiffusion.ts (grid simulation pattern)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:55:22.428263+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:55:22.428263+01:00"}
{"id":"p5.gen-qks","title":"Implement symmetry.ts - Transformation Groups","description":"## Phase 2: Patterns (Module 7 of 12)\n**Complexity:** Low\nPure transforms\n\n## Purpose\nKaleidoscope effects, mandalas, wallpaper patterns.\n\n## Key Exports\n```typescript\nexport type ReflectionAxis = 'horizontal' | 'vertical' | 'diagonal' | 'antiDiagonal';\nexport type FriezeType = 'p1' | 'p11m' | 'p1m1' | 'p2' | 'p2mm' | 'p2mg' | 'p2gm';\n\nexport function rotationalSymmetry(points: readonly p5.Vector[], n: number, center?: p5.Vector): p5.Vector[][];\nexport function reflect(points: readonly p5.Vector[], axis: ReflectionAxis, offset?: number): p5.Vector[];\nexport function glideReflect(points: readonly p5.Vector[], axis: ReflectionAxis, glideDistance: number): p5.Vector[];\nexport function friezePattern(motif: readonly p5.Vector[], type: FriezeType, repetitions: number, spacing: number): p5.Vector[][];\n```\n\n## Required Test Cases\n- 4-fold rotation = 4 copies\n- reflect horizontal preserves y coordinates\n- n=1 → 1 copy (original only)\n- n=0 → return original\n\n## Edge Cases\n- Empty input → return empty array\n- n = 0 or 1 → return original (1 copy)\n- Center on point → don't duplicate center point\n- Negative n → use absolute value\n\n## Visual Test\nFile: `visual-tests/sketches/symmetry.sketch.ts`\nPass condition: 6-fold mandala with clear rotational symmetry\n\n## Reference Pattern\n- src/circle.ts (pure functions)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:55:24.567982+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:55:24.567982+01:00"}
{"id":"p5.gen-qyl","title":"Implement bezier.ts - Curve Math","description":"## Phase 1: Foundation (Module 2 of 12)\n**Complexity:** Low\nPure math, straightforward implementation\n\n## Purpose\nComplements Catmull-Rom. Beziers are the standard for vector graphics.\n\n## Key Exports\n```typescript\nexport function quadraticBezier(t: number, p0: p5.Vector, p1: p5.Vector, p2: p5.Vector): p5.Vector;\nexport function cubicBezier(t: number, p0: p5.Vector, p1: p5.Vector, p2: p5.Vector, p3: p5.Vector): p5.Vector;\nexport function bezierPoints(controls: readonly p5.Vector[], steps: number): p5.Vector[];\nexport function bezierLength(controls: readonly p5.Vector[], samples?: number): number;\nexport function bezierTangent(t: number, controls: readonly p5.Vector[]): p5.Vector;\nexport function splitBezier(t: number, controls: readonly p5.Vector[]): [p5.Vector[], p5.Vector[]];\n```\n\n## Required Test Cases\n- t=0 returns p0\n- t=1 returns p3\n- Collinear points → becomes line\n- Split at 0.5 produces correct segments\n\n## Edge Cases\n- t \u003c 0 or t \u003e 1 → clamp to [0, 1]\n- All control points same → return that point\n- Only 2 control points → linear interpolation\n- steps = 0 → return start and end points only\n\n## Numerical Stability\n- t=1.0000001 from floating point → clamp before compute\n\n## Visual Test\nFile: `visual-tests/sketches/bezier.sketch.ts`\nPass condition: Draws curve with visible control point handles\n\n## Reference Pattern\n- src/catmullRom.ts (curve pattern)\n- src/circle.ts (pure functions)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:53:25.706057+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:53:25.706057+01:00"}
{"id":"p5.gen-s05","title":"Implement simplify.ts - Path Simplification","description":"## Phase 1: Foundation (Module 4 of 12)\n**Complexity:** Low\nDouglas-Peucker is well-documented algorithm\n\n## Purpose\nReduces vertex count for performance. Essential for exporting vector art.\n\n## Key Exports\n```typescript\nexport function douglasPeucker(points: readonly p5.Vector[], epsilon: number): p5.Vector[];\nexport function radialDistance(points: readonly p5.Vector[], epsilon: number): p5.Vector[];\nexport function visvalingam(points: readonly p5.Vector[], minArea: number): p5.Vector[];\n```\n\n## Required Test Cases\n- Less than 3 points → return original\n- epsilon = 0 → return original (no simplification)\n- Closed path preserved\n- Triangle unchanged\n- Straight line → 2 points\n\n## Edge Cases\n- Less than 3 points → return original\n- epsilon = 0 → return original\n- Closed paths → preserve closure\n- Self-intersecting → works but may create artifacts\n\n## Visual Test\nFile: `visual-tests/sketches/simplify.sketch.ts`\nPass condition: Before/after comparison shows reduced vertex count\n\n## Reference Pattern\n- src/circle.ts (pure functions)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:53:28.13935+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:53:28.13935+01:00"}
{"id":"p5.gen-t5m","title":"Implement waves.ts - Oscillation Utilities","description":"## Phase 1: Foundation (Module 3 of 12)\n**Complexity:** Low\nPure math, rename Partial→Harmonic\n\n## Purpose\nEssential for animation, sound visualization, organic motion.\n\n## CRITICAL: Type Naming\n**DO NOT use type name \"Partial\"** - conflicts with TypeScript built-in.\nUse **Harmonic** instead.\n\n## Key Exports\n```typescript\nexport type EaseType = 'linear' | 'in' | 'out' | 'inOut' | 'elastic' | 'bounce';\n\nexport type LissajousParams = {\n  readonly freqX: number;\n  readonly freqY: number;\n  readonly phaseX?: number;\n  readonly phaseY?: number;\n  readonly ampX?: number;\n  readonly ampY?: number;\n};\n\n// RENAMED from Partial to avoid TypeScript conflict\nexport type Harmonic = {\n  readonly frequency: number;\n  readonly amplitude: number;\n  readonly phase?: number;\n};\n\nexport function sine(t: number, freq?: number, amp?: number, phase?: number): number;\nexport function cosine(t: number, freq?: number, amp?: number, phase?: number): number;\nexport function lissajous(t: number, params: LissajousParams): p5.Vector;\nexport function lissajousPath(params: LissajousParams, steps: number): p5.Vector[];\nexport function harmonics(t: number, harmonics: readonly Harmonic[]): number;\nexport function ease(t: number, type: EaseType): number;\n```\n\n## Required Test Cases\n- freq=0 → constant value\n- ease(0) = 0\n- ease(1) = 1\n- Lissajous 1:2 ratio produces figure-8 shape\n\n## Edge Cases\n- frequency = 0 → return constant (amplitude)\n- Negative frequency → invert phase\n- amplitude = 0 → return 0\n\n## Visual Test\nFile: `visual-tests/sketches/waves.sketch.ts`\nPass condition: Animated Lissajous completes one period\n\n## Reference Pattern\n- src/circle.ts (pure functions)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:53:27.000858+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:53:27.000858+01:00"}
{"id":"p5.gen-uzf","title":"Implement spiral.ts - Spiral Patterns","description":"## Phase 3: Simulations (Module 12 of 12)\n**Complexity:** Low\nPure math, GOLDEN_ANGLE constant\n\n## Purpose\nPhyllotaxis, golden ratio patterns, natural arrangements like sunflower seeds.\n\n## Key Exports\n```typescript\nexport type SpiralType = 'archimedean' | 'logarithmic' | 'fermat' | 'hyperbolic';\n\nexport type SpiralConfig = {\n  readonly a?: number;\n  readonly b?: number;\n  readonly turns?: number;\n  readonly pointsPerTurn?: number;\n};\n\nexport function archimedeanSpiral(t: number, a: number, b: number): p5.Vector;\nexport function logarithmicSpiral(t: number, a: number, b: number): p5.Vector;\nexport function fermatSpiral(n: number, c: number): p5.Vector;\nexport function hyperbolicSpiral(t: number, a: number): p5.Vector;\nexport function fibonacciSunflower(n: number, radius: number): p5.Vector[];\nexport function spiralPath(type: SpiralType, config: SpiralConfig): p5.Vector[];\n\n/** Golden angle in radians (~2.39996 or ~137.5°) */\nexport const GOLDEN_ANGLE: number;\n```\n\n## Note on PHI\nPHI is already exported from penrose.ts. Do NOT re-export.\nInstead, export GOLDEN_ANGLE (which is 2*PI - 2*PI/PHI ≈ 2.39996 radians).\n\n## Required Test Cases\n- Archimedean at t=0 is origin\n- fibonacciSunflower(1) → single point at center\n- n=0 → empty array\n- GOLDEN_ANGLE is correctly exported\n\n## Edge Cases\n- Zero turns → return single point at center\n- Negative turns → reverse direction\n- Very tight spirals → may need more points\n- Logarithmic spiral at t=0 → return origin directly\n\n## Numerical Stability\n- Logarithmic spiral at t=0 → return origin directly (avoid log(0))\n\n## Visual Test\nFile: `visual-tests/sketches/spiral.sketch.ts`\nPass condition: Golden sunflower pattern with 200+ seeds, recognizable phyllotaxis\n\n## Reference Pattern\n- src/circle.ts (pure functions)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:57:18.578509+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:57:18.578509+01:00"}
{"id":"p5.gen-vjs","title":"Implement forceGraph.ts - Network Layouts","description":"## Phase 3: Simulations (Module 11 of 12)\n**Complexity:** Medium\nIterative convergence algorithm\n\n## Purpose\nForce-directed layout for visualizing relationships, knowledge graphs, social networks.\n\n## Key Exports\n```typescript\nimport { type Point2D } from './penrose';\nimport { type Quadtree } from './quadtree';\n\nexport type GraphNode = {\n  readonly id: string;\n  readonly x: number;  // For Point2D compatibility\n  readonly y: number;\n  position: p5.Vector;\n  velocity: p5.Vector;\n  mass: number;\n  fixed: boolean;\n  data?: unknown;\n};\n\nexport type GraphEdge = {\n  readonly from: string;\n  readonly to: string;\n  readonly weight: number;\n};\n\nexport type ForceGraphConfig = {\n  readonly repulsionStrength?: number;\n  readonly attractionStrength?: number;\n  readonly damping?: number;\n  readonly centerGravity?: number;\n  readonly useQuadtree?: boolean;\n};\n\nexport class ForceDirectedGraph {\n  constructor(config?: ForceGraphConfig);\n  addNode(id: string, position?: p5.Vector, data?: unknown): GraphNode;\n  removeNode(id: string): void;\n  addEdge(from: string, to: string, weight?: number): void;\n  removeEdge(from: string, to: string): void;\n  step(): void;\n  simulate(iterations?: number): void;\n  getNode(id: string): GraphNode | undefined;\n  getNodes(): readonly GraphNode[];\n  getEdges(): readonly GraphEdge[];\n  isStable(threshold?: number): boolean;\n}\n\nexport function createForceGraph(config?: ForceGraphConfig): ForceDirectedGraph;\n```\n\n## Required Test Cases\n- Single node → positioned at center\n- 2 connected nodes → find equilibrium distance\n- isStable() returns true when converged\n- Disconnected components handled\n\n## Edge Cases\n- Disconnected graph → handle multiple components\n- Self-loops → ignore for force calculation\n- Zero-weight edges → treat as no connection\n- Single node → position at center\n\n## Numerical Stability\n- Division by zero when nodes overlap → add epsilon to distance\n\n## Performance\n- Max iterations = 300 to prevent non-convergence\n- Use Quadtree for Barnes-Hut optimization (optional)\n\n## Visual Test\nFile: `visual-tests/sketches/force-graph.sketch.ts` (kebab-case!)\nPass condition: 10-node graph settles to spread-out, non-overlapping layout\n\n## Reference Pattern\n- src/circlePacking.ts (physics simulation pattern)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-02T13:57:17.423279+01:00","created_by":"martinblasko","updated_at":"2026-01-02T13:57:17.423279+01:00","dependencies":[{"issue_id":"p5.gen-vjs","depends_on_id":"p5.gen-c7o","type":"blocks","created_at":"2026-01-02T13:58:47.626317+01:00","created_by":"martinblasko"}]}
